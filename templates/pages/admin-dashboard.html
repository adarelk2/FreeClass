<!doctype html>
<html lang="he" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>לוח בקרה - מנהל מערכת</title>

  <!-- Tailwind CDN -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Lucide Icons CDN -->
  <script src="https://unpkg.com/lucide@latest"></script>
</head>

<body class="min-h-screen bg-slate-100">

  <!-- Admin Header -->
  <header class="bg-slate-900 text-white">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 py-4">
      <div class="flex items-center justify-between gap-4 flex-wrap">
        <div class="flex items-center gap-3">
          <div class="w-10 h-10 rounded-xl bg-sky-600 flex items-center justify-center">
            <i data-lucide="settings" class="w-5 h-5"></i>
          </div>
          <div>
            <h1 class="text-xl font-bold">לוח בקרה - מנהל מערכת</h1>
            <p class="text-sm text-slate-400">ניהול חדרים וחיישנים</p>
          </div>
        </div>

        <a href="admin-login.html"
           class="inline-flex items-center gap-2 px-3 py-2 rounded-md hover:bg-slate-800 transition text-sm text-slate-300">
          <i data-lucide="log-out" class="w-4 h-4"></i>
          התנתק
        </a>
      </div>
    </div>
  </header>

  <main class="max-w-7xl mx-auto px-4 sm:px-6 py-6 space-y-6">

    <!-- Tabs -->
    <section class="w-full">
      <div class="bg-white shadow-sm p-1 rounded-xl inline-flex gap-1">
        <button class="tab-btn px-4 py-2 rounded-lg text-sm font-medium transition" data-tab="rooms">ניהול חדרים</button>
        <button class="tab-btn px-4 py-2 rounded-lg text-sm font-medium transition" data-tab="schedule">לוח שעות</button>
        <button class="tab-btn px-4 py-2 rounded-lg text-sm font-medium transition" data-tab="sensors">חיישנים</button>
        <button class="tab-btn px-4 py-2 rounded-lg text-sm font-medium transition" data-tab="buildings">ניהול בניינים</button>
      </div>

      <!-- Rooms -->
      <div class="tab-panel mt-6" id="tab-rooms">
        <div class="bg-white rounded-xl shadow-sm p-6">
          <p class="text-slate-600">ניהול חדרים (כמו אצלך)</p>
        </div>
      </div>

      <!-- Schedule -->
      <div class="tab-panel mt-6 hidden" id="tab-schedule">
        <div class="bg-white rounded-xl shadow-sm p-6">
          <p class="text-slate-600">לוח שעות שבועי</p>
        </div>
      </div>

      <!-- Sensors -->
      <div class="tab-panel mt-6 hidden" id="tab-sensors">
        <div class="bg-white rounded-xl shadow-sm p-6">
          <p class="text-slate-600">מצב חיישנים</p>
        </div>
      </div>

      <!-- Buildings -->
      <div class="tab-panel mt-6 hidden" id="tab-buildings">
        <div class="bg-white rounded-xl shadow-sm">
          <div class="p-6 border-b border-slate-100 flex items-center justify-between">
            <h2 class="text-lg font-semibold text-slate-800">ניהול בניינים</h2>
            <button id="addBuildingBtn"
                    class="h-10 px-4 rounded-md bg-sky-600 text-white hover:bg-sky-700 transition text-sm inline-flex items-center gap-2">
              <i data-lucide="plus" class="w-4 h-4"></i>
              הוסף בניין
            </button>
          </div>

          <div class="p-6 overflow-x-auto">
            <table class="w-full text-sm">
              <thead>
                <tr class="text-slate-500 border-b">
                  <th class="text-right py-3">שם בניין</th>
                  <th class="text-right py-3">מספר כיתות</th>
                  <th class="text-right py-3">קומות</th>
                  <th class="text-right py-3">פעולות</th>
                </tr>
              </thead>
              <tbody id="buildingsTbody" class="divide-y"></tbody>
            </table>
          </div>
        </div>
      </div>

    </section>
  </main>

  <script>
<!--    let buildings = [-->
<!--      { id: 1, name: 'בניין הנדסה', address: 'רחוב המדע 12', floors: 5 },-->
<!--      { id: 2, name: 'בניין מדעים', address: 'שדרות האוניברסיטה 3', floors: 4 },-->
<!--      { id: 3, name: 'ספרייה מרכזית', address: 'כיכר הידע 1', floors: 3 },-->
<!--    ];-->
    const buildings = {{ buildings_server | tojson }};

    function renderBuildingsTable() {
      const tbody = document.getElementById('buildingsTbody');

      tbody.innerHTML = buildings.map(b => `
        <tr>
          <td class="py-3 font-medium text-slate-800">${b.building_name}</td>
          <td class="py-3 text-slate-500">${b.address}</td>
          <td class="py-3 text-slate-500">${b.floors}</td>
          <td class="py-3">
            <button onclick="deleteBuilding(${b.id})"
                    class="px-3 py-1 rounded-md border border-red-200 text-red-600 hover:bg-red-50 text-sm">
              מחק
            </button>
          </td>
        </tr>
      `).join('');

      lucide.createIcons();
    }

    function deleteBuilding(id) {
      buildings = buildings.filter(b => b.id !== id);
      renderBuildingsTable();
    }

    document.getElementById('addBuildingBtn').addEventListener('click', () => {
      const name = prompt('שם בניין:');
      if (!name) return;

      buildings.push({
        id: Date.now(),
        name,
        address: 'לא הוגדר',
        floors: 1
      });

      renderBuildingsTable();
    });

    function setActiveTab(tab) {
      document.querySelectorAll('.tab-panel').forEach(p => p.classList.add('hidden'));
      document.getElementById(`tab-${tab}`).classList.remove('hidden');

      document.querySelectorAll('.tab-btn').forEach(b => {
        b.className = `tab-btn px-4 py-2 rounded-lg text-sm font-medium transition ${
          b.dataset.tab === tab ? 'bg-slate-900 text-white' : 'text-slate-700 hover:bg-slate-100'
        }`;
      });
    }

    document.querySelectorAll('.tab-btn').forEach(btn => {
      btn.addEventListener('click', () => setActiveTab(btn.dataset.tab));
    });

    renderBuildingsTable();
    setActiveTab('rooms');
    lucide.createIcons();
  </script>

</body>
</html>
